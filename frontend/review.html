<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Avis - Vite & Gourmand</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"><link rel="stylesheet" href="/css/style.css"></head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark sticky-top" style="background:rgba(0,0,0,.6)">
<div class="container"><a class="navbar-brand fw-bold" href="/">Vite &amp; Gourmand</a>
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="nav">
<ul class="navbar-nav ms-auto gap-2">
<li class="nav-item"><a class="nav-link" href="/menus.html">Menus</a></li>
<li class="nav-item"><a class="nav-link" href="/contact.html">Contact</a></li>
<li class="nav-item"><a class="nav-link" href="/dashboard.html">Espace</a></li>
<li class="nav-item"><a class="nav-link" href="/login.html" id="navLogin">Connexion</a></li>
<li class="nav-item"><button class="btn btn-sm btn-outline-light" id="navLogout" style="display:none">Déconnexion</button></li>
</ul></div></div></nav>
<main class="container py-4">
<h1 class="h4">Donner un avis</h1>
<div class="card p-3">
<label class="form-label">Note (1 à 5)</label><input id="rating" class="form-control" type="number" min="1" max="5" value="5">
<label class="form-label mt-2">Commentaire</label><textarea id="comment" class="form-control" rows="4"></textarea>
<button class="btn btn-vg mt-3" id="btn">Envoyer</button>
<div id="msg" class="mt-2" aria-live="polite"></div>
<div class="text-secondary small mt-2">Avis visible après validation employé.</div>
</div>
</main>
<footer class="py-4" style="border-top:1px solid #2a2d33"><div class="container d-flex flex-column flex-md-row justify-content-between gap-3">
<div><div class="fw-bold">Horaires</div><div>Lun–Dim : 09:00–19:00</div></div>
<div class="d-flex gap-3"><a href="/legal.html">Mentions légales</a><a href="/cgv.html">CGV</a></div></div></footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script type="module">import{getUser,clearSession}from"/js/api.js";const u=getUser();const l=document.getElementById("navLogin");const o=document.getElementById("navLogout");
if(u){l.style.display="none";o.style.display="inline-block"};o?.addEventListener("click",()=>{clearSession();location.href="/"});</script>

<script type="module">
import { api, requireLogin } from "/js/api.js";
if(!requireLogin()) {}
const orderId=new URLSearchParams(location.search).get("orderId");
btn.addEventListener("click", async ()=>{
  msg.textContent="";
  try{ await api("/api/reviews",{method:"POST",body:{orderId:Number(orderId),rating:Number(rating.value),comment:comment.value.trim()}});
    msg.innerHTML='<div class="text-success">Avis envoyé.</div>';
  }catch(e){ msg.innerHTML=`<div class="text-danger">${e.message}</div>`; }
});
</script>
</body></html>